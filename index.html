<!DOCTYPE html>
    <html>
        <head>
             <meta charset="utf-8" />
             <title>Choose a music</title>
             <link rel="stylesheet" href="style.css" type="text/css" />
             <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
             <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
             <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>
             <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-firestore.js"></script>
             <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
             <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
             <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        </head>
        <body>
            <h1 class="h1" style="text-align:center">Musics List</h1>
            <div class="container">
                <div class="row">
                    <div class="col-sm" id="dynamic">      
                    </div>
                </div>
            </div>
           <script type="text/javascript">

                var xhr = new XMLHttpRequest();

                function request(url){
                   console.log(url)
                   //xhr.open('GET', url, true);
                   //xhr.send(null); A dÃ©commenter pour lancer la musique
               }

               firebase.initializeApp({
                   apiKey: 'AIzaSyBEBk4Jimmjz-3VMuhi5pVeDKNrdIr7WIc',
                   authDomain: 'test-41ffd.firebaseapp.com',
                   projectId: 'test-41ffd'
               });

               var db = firebase.firestore();

               var array = [];

               db.collection("musics").get().then(function(querySnapshot) {

                   querySnapshot.forEach(function(doc) {
                    				// doc.data() is never undefined for query doc snapshots
                    				console.log(doc.id, " => ", doc.data());
                    				array.push(doc.data().name)
                                });
               }).then( () => {

				// construire la page html ici avec array
	
			   var prefix = "https://us-central1-test-41ffd.cloudfunctions.net/hello?name="

		       var dynamic = document.getElementById("dynamic")

               var styles = ["btn-primary","btn-success","btn-info","btn-warning","btn-danger"]

               var s = 0;

               for(var i=0; i<array.length; i++){

                    var newButton = document.createElement("button")

					newButton.setAttribute( "onClick", "request('"+prefix+array[i]+"');" )

					newButton.innerHTML = array[i].split(".")[0]

					newButton.classList.add("btn") //
                    newButton.classList.add(styles[s])
                    newButton.classList.add("ribbon")

                    newButton.style.marginBottom = "20px"

					dynamic.appendChild(newButton)

                    s++
                    if(s>4){
                        s=0
                    }

				}

				//BOUTON STOP

				var stop = document.createElement("button")

				stop.setAttribute( "onClick", "request('"+prefix+"stop');" );

				stop.innerHTML = "STOP"

				stop.classList.add("btn")
                stop.classList.add(styles[s])
                stop.classList.add("ribbon")

				dynamic.appendChild(stop);

			});
         </script>
    </body>
    </html>
